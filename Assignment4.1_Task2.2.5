import pandas as pd
import numpy as np

# Find out the business days of 2015
b_day = pd.bdate_range('2015-01-01', '2015-12-31')

#Use business day of 2015 as index to a series of random numbers
bday_index = pd.Series(np.random.randn(len(b_day)), index=b_day)

df = pd.DataFrame({'numbers': np.random.randn(len(b_day)), 'dates': b_day})
totalValues_Wed = df[df['dates'].dt.weekday_name == 'Wednesday'].sum()

##Average For each calendar month

# Set a new column of month of each dates
df['month'] = df['dates'].dt.month

# apply group by to select each calender month and then apply mean() to get the average of each month
avgCalenderMonth = df.groupby('month').mean()


# For each group of four consecutive calendar months in s, find the date on which the
# highest value occurred.

# create group on consecutive 4 months
df['monthGrp'] = df['month'].apply(lambda x: np.floor((x/4)) - 1
                                   if x % 4 == 0 else np.floor((x/4)))
df2 = df.loc[df.groupby('monthGrp')['numbers'].idxmax()]
print(df2)
